<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-PROSEDUR - Direktorat Operation Dept Supplay Chain</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #003366; border-radius: 10px; }
    </style>
</head>
<body class="bg-[#F0F2F5]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // ==========================================================
        // DATA DOKUMEN (EDIT BAGIAN INI UNTUK MENAMBAH DATA PERMANEN)
        // ==========================================================
        const INITIAL_DOCS = [
            { id: 1, judul: "Prosedur Pengadaan Barang", jenis: "SOP", departemen: "Logistik", update: "12 Jan 2024", link: "https://drive.google.com/file/d/1example/view" },
            { id: 2, judul: "Instruksi Kerja Stock Opname", jenis: "IK", departemen: "Gudang", update: "15 Jan 2024", link: "https://drive.google.com/file/d/2example/view" },
        ];

        const GD_FOLDER_URL = "https://drive.google.com/drive/folders/1oPrp8f0knk7G1VsGCwu_8GWGf1Fe7MgZ";

        /**
         * Komponen Icon yang diperbaiki untuk mencegah error 'removeChild'
         * Kita menggunakan ref dan manipulasi innerHTML agar React mengabaikan 
         * perubahan yang dilakukan oleh pustaka Lucide pada elemen ini.
         */
        const Icon = ({ name, className }) => {
            const iconRef = useRef(null);

            useEffect(() => {
                if (iconRef.current) {
                    // Masukkan elemen i secara manual
                    iconRef.current.innerHTML = `<i data-lucide="${name}" class="${className}"></i>`;
                    // Jalankan Lucide hanya pada elemen ini
                    lucide.createIcons({
                        node: iconRef.current
                    });
                }
            }, [name, className]);

            // Menggunakan span sebagai kontainer agar React tidak bingung saat Lucide mengganti tag i menjadi svg
            return <span ref={iconRef} className="inline-flex items-center justify-center"></span>;
        };

        function App() {
            const [isAdmin, setIsAdmin] = useState(false);
            const [showLoginModal, setShowLoginModal] = useState(false);
            const [documents, setDocuments] = useState(INITIAL_DOCS);
            const [searchTerm, setSearchTerm] = useState('');
            const [showPassword, setShowPassword] = useState(false);
            const [loginForm, setLoginForm] = useState({ username: '', password: '' });
            const [loginError, setLoginError] = useState('');
            
            const [formData, setFormData] = useState({
                judul: '', jenis: 'SOP', departemen: '', link: '',
                update: new Date().toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' })
            });

            // Logika Pengelompokan Data
            const groupedDocs = useMemo(() => {
                const filtered = documents.filter(doc => 
                    (doc.judul?.toLowerCase() || "").includes(searchTerm.toLowerCase()) ||
                    (doc.departemen?.toLowerCase() || "").includes(searchTerm.toLowerCase())
                );
                const depts = [...new Set(filtered.map(d => d.departemen))].sort();
                return depts.map(dept => ({
                    name: dept,
                    categories: [
                        { type: "SOP (Standard Operating Procedure)", items: filtered.filter(d => d.departemen === dept && d.jenis === "SOP") },
                        { type: "IK (Instruksi Kerja)", items: filtered.filter(d => d.departemen === dept && d.jenis === "IK") }
                    ].filter(cat => cat.items.length > 0)
                }));
            }, [documents, searchTerm]);

            const handleLogin = (e) => {
                e.preventDefault();
                if (loginForm.username === 'admin' && loginForm.password === 'admin123') {
                    setIsAdmin(true); 
                    setShowLoginModal(false); 
                    setLoginError('');
                } else { 
                    setLoginError('ID atau Password salah!'); 
                }
            };

            const handleAddLocal = (e) => {
                e.preventDefault();
                const newDoc = { ...formData, id: Date.now() };
                setDocuments([newDoc, ...documents]);
                const confirmSave = confirm("Berhasil ditambah ke tampilan! \n\nINGAT: Anda harus menyalin kode data baru ini ke file index.html Anda di GitHub agar tersimpan permanen.");
                setFormData({ ...formData, judul: '', link: '' });
            };

            const handleDeleteLocal = (id) => {
                if(confirm("Hapus dokumen ini dari daftar?")) {
                    setDocuments(documents.filter(d => d.id !== id));
                }
            };

            return (
                <div className="min-h-screen">
                    {/* Header */}
                    <nav className="bg-[#003366] sticky top-0 z-20 shadow-lg border-b-4 border-[#FFCC00]">
                        <div className="max-w-6xl mx-auto px-6 py-3 flex flex-col md:flex-row items-center justify-between gap-4 text-white">
                            <div className="flex items-center gap-4">
                                <div className="bg-[#FFCC00] p-2 rounded-lg shadow-md">
                                    <Icon name="shield-check" className="w-6 h-6 text-[#003366]" />
                                </div>
                                <div>
                                    <h1 className="text-lg font-black leading-none uppercase tracking-tighter">E-PROSEDUR</h1>
                                    <p className="text-[10px] text-[#FFCC00] mt-1 font-bold uppercase tracking-widest leading-none">Direktorat Operation Dept Supplay Chain</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-3 w-full md:w-auto text-slate-900">
                                <div className="relative flex-1 md:w-64">
                                    <input type="text" placeholder="Cari dokumen..." className="w-full pl-10 pr-4 py-2 rounded text-sm outline-none focus:ring-2 focus:ring-[#FFCC00] bg-white" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} />
                                    <div className="absolute left-3 top-2.5">
                                        <Icon name="search" className="w-4 h-4 text-slate-400" />
                                    </div>
                                </div>
                                <button onClick={() => isAdmin ? setIsAdmin(false) : setShowLoginModal(true)} className="px-5 py-2 bg-[#FFCC00] text-[#003366] rounded font-bold text-sm shadow-md hover:bg-white transition-all flex items-center gap-2">
                                    <Icon name={isAdmin ? "log-out" : "user"} className="w-4 h-4" />
                                    {isAdmin ? 'Logout' : 'Admin'}
                                </button>
                            </div>
                        </div>
                    </nav>

                    {/* Modal Login */}
                    {showLoginModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm animate-fade-in text-slate-900">
                            <form onSubmit={handleLogin} className="bg-white rounded-xl shadow-2xl w-full max-w-md border-t-8 border-[#FFCC00] p-8">
                                <h2 className="text-xl font-black text-[#003366] mb-6 uppercase flex items-center gap-2">
                                    <Icon name="lock" className="w-5 h-5" /> Login Admin
                                </h2>
                                {loginError && <p className="bg-red-50 text-red-600 text-xs font-bold p-3 rounded mb-4 italic">⚠️ {loginError}</p>}
                                <div className="space-y-4">
                                    <input required type="text" placeholder="ID User (admin)" className="w-full p-3 bg-slate-50 border rounded outline-none focus:ring-2 focus:ring-[#003366]" value={loginForm.username} onChange={e => setLoginForm({...loginForm, username: e.target.value})} />
                                    <div className="relative">
                                        <input required type={showPassword ? "text" : "password"} placeholder="Sandi (admin123)" className="w-full p-3 bg-slate-50 border rounded outline-none focus:ring-2 focus:ring-[#003366]" value={loginForm.password} onChange={e => setLoginForm({...loginForm, password: e.target.value})} />
                                        <button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute right-3 top-3.5 text-slate-400">
                                            <Icon name={showPassword ? "eye-off" : "eye"} className="w-4 h-4" />
                                        </button>
                                    </div>
                                </div>
                                <button className="w-full mt-8 bg-[#003366] text-white py-3.5 rounded font-black uppercase tracking-widest shadow-xl transition-all">Masuk</button>
                                <button type="button" onClick={() => setShowLoginModal(false)} className="w-full mt-2 text-slate-400 text-[10px] font-black uppercase py-2 hover:text-[#003366]">Batal</button>
                            </form>
                        </div>
                    )}

                    <main className="max-w-6xl mx-auto px-6 py-10">
                        {isAdmin ? (
                            <div className="space-y-8 animate-fade-in text-slate-900">
                                <div className="bg-white rounded shadow-sm overflow-hidden border">
                                    <div className="bg-[#003366] p-4 text-white font-bold text-sm uppercase flex items-center justify-between">
                                        <span className="flex items-center gap-2"><Icon name="plus-circle" className="w-4 h-4 text-[#FFCC00]" /> Manajemen Dokumen</span>
                                        <a href={GD_FOLDER_URL} target="_blank" className="bg-[#FFCC00] text-[#003366] px-3 py-1 rounded text-[10px] font-black hover:bg-white transition-colors">UPLOAD KE DRIVE</a>
                                    </div>
                                    <form onSubmit={handleAddLocal} className="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div className="space-y-4">
                                            <input required placeholder="Judul Dokumen" className="w-full p-2.5 border rounded" value={formData.judul} onChange={e => setFormData({...formData, judul: e.target.value})} />
                                            <input required placeholder="Unit Kerja / Dept" className="w-full p-2.5 border rounded" value={formData.departemen} onChange={e => setFormData({...formData, departemen: e.target.value})} />
                                            <div className="grid grid-cols-2 gap-4">
                                                <select className="p-2.5 border rounded font-bold" value={formData.jenis} onChange={e => setFormData({...formData, jenis: e.target.value})}>
                                                    <option value="SOP">SOP</option>
                                                    <option value="IK">IK</option>
                                                </select>
                                                <input className="p-2.5 border rounded bg-slate-50" value={formData.update} disabled />
                                            </div>
                                            <input required placeholder="Link Google Drive" className="w-full p-2.5 border rounded" value={formData.link} onChange={e => setFormData({...formData, link: e.target.value})} />
                                        </div>
                                        <div className="bg-amber-50 p-6 rounded-lg border border-amber-200">
                                            <h4 className="text-amber-800 font-bold text-xs uppercase mb-2 flex items-center gap-2">
                                                <Icon name="info" className="w-4 h-4" /> Instruksi
                                            </h4>
                                            <ol className="text-[11px] text-amber-700 list-decimal pl-4 space-y-2">
                                                <li>Simpan file di Google Drive.</li>
                                                <li>Bagikan file (Anyone with link).</li>
                                                <li>Tempel tautan ke form di samping.</li>
                                                <li>Setelah klik "Tambah", jangan lupa perbarui file <code>index.html</code> Anda di repositori GitHub secara manual.</li>
                                            </ol>
                                        </div>
                                        <div className="md:col-span-2 flex justify-end border-t pt-4">
                                            <button className="bg-[#003366] text-white px-8 py-3 rounded font-black text-xs uppercase tracking-widest shadow-lg">Tambah Ke Daftar</button>
                                        </div>
                                    </form>
                                </div>

                                <div className="bg-white rounded border shadow-sm overflow-hidden">
                                    <table className="w-full text-left text-sm">
                                        <thead className="bg-[#003366] text-[#FFCC00] uppercase text-[10px] font-black">
                                            <tr><th className="p-4">Dokumen</th><th className="p-4">Unit</th><th className="p-4 text-center">Tipe</th><th className="p-4 text-right">Aksi</th></tr>
                                        </thead>
                                        <tbody className="divide-y">
                                            {documents.map(d => (
                                                <tr key={d.id} className="hover:bg-slate-50">
                                                    <td className="p-4 font-bold text-[#003366]">{d.judul}</td>
                                                    <td className="p-4 uppercase text-xs font-bold text-slate-500">{d.departemen}</td>
                                                    <td className="p-4 text-center">
                                                        <span className={`text-[9px] font-black px-2 py-0.5 rounded border ${d.jenis === 'SOP' ? 'border-blue-100 text-blue-600 bg-blue-50' : 'border-amber-200 text-amber-600 bg-amber-50'}`}>{d.jenis}</span>
                                                    </td>
                                                    <td className="p-4 text-right">
                                                        <button onClick={() => handleDeleteLocal(d.id)} className="p-2 text-red-500 hover:bg-red-50 rounded"><Icon name="trash-2" className="w-4 h-4" /></button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        ) : (
                            /* TAMPILAN PENGGUNA */
                            <div className="animate-fade-in">
                                <div className="mb-12 bg-white p-10 rounded-xl border-l-8 border-[#003366] shadow-xl flex flex-col md:flex-row items-center gap-8 relative overflow-hidden">
                                    <div className="bg-[#003366] p-5 rounded-xl shadow-lg relative z-10 text-[#FFCC00]">
                                        <Icon name="book-open" className="w-12 h-12" />
                                    </div>
                                    <div className="relative z-10 text-slate-900 text-center md:text-left">
                                        <h2 className="text-3xl font-black text-[#003366] uppercase tracking-tighter leading-none mb-2">Pusat Data Prosedur Kerja</h2>
                                        <div className="h-1 w-20 bg-[#FFCC00] mt-2 mb-3 mx-auto md:mx-0"></div>
                                        <p className="text-slate-500 text-sm italic leading-relaxed max-w-xl">Direktorat Operation Dept Supplay Chain.</p>
                                    </div>
                                </div>

                                <div className="space-y-20">
                                    {groupedDocs.map(dept => (
                                        <div key={dept.name} className="relative">
                                            <div className="flex items-center gap-4 mb-10">
                                                <div className="bg-[#003366] p-2.5 rounded shadow-lg text-[#FFCC00]"><Icon name="building-2" className="w-6 h-6" /></div>
                                                <h2 className="text-2xl font-black text-[#003366] uppercase tracking-tight">{dept.name}</h2>
                                            </div>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-10 ml-4">
                                                {dept.categories.map(cat => (
                                                    <div key={cat.type}>
                                                        <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mb-6 flex items-center gap-2">
                                                            <div className="h-px flex-1 bg-slate-200"></div>
                                                            {cat.type}
                                                            <div className="h-px w-6 bg-slate-200"></div>
                                                        </h3>
                                                        <div className="space-y-4">
                                                            {cat.items.map(item => (
                                                                <a key={item.id} href={item.link} target="_blank" className="flex items-center justify-between p-5 bg-white border border-slate-200 rounded-lg hover:border-[#003366] hover:shadow-2xl transition-all group">
                                                                    <div className="flex items-center gap-5">
                                                                        <div className="p-3 bg-slate-50 group-hover:bg-[#003366] rounded-xl transition-colors text-slate-400 group-hover:text-[#FFCC00]">
                                                                            <Icon name="file-text" className="w-6 h-6" />
                                                                        </div>
                                                                        <div>
                                                                            <p className="text-sm font-bold text-[#003366] group-hover:text-black uppercase tracking-tight transition-colors">{item.judul}</p>
                                                                            <p className="text-[10px] font-black text-slate-400 mt-1 uppercase tracking-widest leading-none">UPDATE: {item.update}</p>
                                                                        </div>
                                                                    </div>
                                                                    <div className="bg-[#003366] p-2 rounded-full opacity-0 group-hover:opacity-100 transition-all translate-x-4 group-hover:translate-x-0 shadow-lg text-[#FFCC00]">
                                                                        <Icon name="chevron-right" className="w-4 h-4" />
                                                                    </div>
                                                                </a>
                                                            ))}
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </main>

                    <footer className="bg-[#002244] border-t-8 border-[#FFCC00] py-20 mt-20 text-center text-white">
                        <div className="bg-[#FFCC00] w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl text-[#003366]">
                            <Icon name="shield-check" className="w-10 h-10" />
                        </div>
                        <p className="text-[#FFCC00] text-xs font-black uppercase tracking-[0.5em] mb-4 leading-none">Dokumentasi Terpadu</p>
                        <p className="text-white/40 text-[10px] font-bold uppercase tracking-widest leading-relaxed max-w-sm mx-auto">
                            Direktorat Operation Dept Supplay Chain &copy; 2024 <br/>
                            Sistem Manajemen Prosedur Kerja <br/>
                            <span className="text-[#FFCC00]/50 tracking-[0.3em]">GuoKing_</span>
                        </p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
